---
# Dnf tasks (to be included into other role plays).
# Target hosts: N/A
#

- name: Execute all the Dnf actions
  become: true
  when: inventory_hostname != 'localhost'
  ignore_errors: true
  block:
  - name: Update all OS packages
    dnf:
      name: '*'
      state: latest

  - name: Install per parent role additional packages
    loop: "{{ packages }}"
    dnf:
      name: "{{ item.regex_name }}"
      state: latest

  - name: Dnf autoremove
    dnf:
      autoremove: yes

  - name: Dnf clean all
    command: dnf clean all
    ignore_errors: true

  - name: Update mlocate DB (register all the files into the VM)
    command: updatedb

...
